{"version":3,"file":"MatrixInput.js","sources":["../MatrixInput.js"],"names":["$","Craft","MatrixInput","Garnish","Base","extend","id","blockTypes","blockTypesByHandle","inputNamePrefix","inputIdPrefix","maxBlocks","showingAddBlockMenu","addBlockBtnGroupWidth","addBlockBtnContainerWidth","$container","$blockContainer","$addBlockBtnContainer","$addBlockBtnGroup","$addBlockBtnGroupBtns","blockSort","blockSelect","totalNewBlocks","init","this","formatInputId","children","$addBlockMenuBtn","setNewBlockBtn","i","length","blockType","handle","$blocks","collapsedBlocks","getCollapsedBlockIds","DragSort","axis","filter","proxy","$targetItem","hasClass","getSelectedItems","collapseDraggees","magnetStrength","helperLagBase","helperOpacity","onSortChange","resetItemOrder","Select","multi","vertical","checkboxMode","$block","data","newMatch","match","parseInt","block","MatrixBlock","inArray","collapse","addListener","ev","type","target","addBlock","MenuBtn","onOptionSelect","option","updateAddBlockBtn","width","addClass","removeClass","navigator","userAgent","indexOf","requestAnimationFrame","css","canAddMoreBlocks","$insertBefore","html","getBlockTypeByHandle","name","t","insertBefore","appendTo","$fieldsContainer","bodyHtml","getParsedBlockHtml","footHtml","getHiddenBlockCss","velocity","opacity","margin-bottom","$bod","append","initUiElements","addItems","scrollContainerToElement","collapseSelectedBlocks","callOnSelectedBlocks","expandSelectedBlocks","disableSelectedBlocks","enableSelectedBlocks","deleteSelectedBlocks","fn","$selectedItems","eq","marginBottom","outerHeight","replace","collapsedBlockStorageKey","siteUid","localStorage","filterArray","split","setCollapsedBlockIds","ids","join","rememberCollapsedBlockId","Storage","push","forgetCollapsedBlockId","collapsedBlocksIndex","splice","matrix","$titlebar","$previewContainer","$actionMenu","$collapsedInput","isNew","collapsed","substr","$menuBtn","find","menuBtn","menu","settings","hasAttr","preventDefault","toggle","expand","animate","previewHtml","$fields","$field","$inputs","inputPreviewText","j","value","$input","$maybeLightswitchContainer","parent","text","getText","getInputPostVal","Array","trim","duration","height","show","hide","setTimeout","val","collapsedContainerHeight","expandedContainerHeight","disable","enable","onMenuOptionSelect","batchAction","totalSelected","isSelected","$option","confirm","selfDestruct","remove","jQuery"],"mappings":"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"}